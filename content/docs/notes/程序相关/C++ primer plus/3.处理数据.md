---
date: 2023-12-07
title: 03.处理数据
weight: 3
---
# 3. 处理数据
面向对象编程的本质是设计并扩展自己的数据类型。创建自己的类型之前，需要了解c++内置类型。

## 3.1 内置类型
内置类型（也称基本类型）由 C++ 语言标准指定，内置于编译器中。不在任何头文件中定义。关于内置类型大小[可以参考](https://learn.microsoft.com/zh-cn/cpp/cpp/data-type-ranges?view=msvc-170)

主要分为三个类别：整形、浮点和void。

**1. 整形**
c++基本整形分别是char、short、int、long和long long。其中char比较特殊，常用来表示字符。

默认都带符号，使用unsigned修饰符可以指定一个非负的无符号表现形式。

在不同系统的实现中同种类型存储大小、宽度会有所不同。但c++标准中指定各个整形的大小关系一致。

**2. 浮点型**
主要有flaot、double和long double。


## 3.2 const限定符
const指定变量的值为常量防止对其修改。

const与#define相比，const更好：

1. consst明确指定类型
2. 可以使用c++作用域规则将定义限制在特定的函数或文件中
3. const可以用于更复杂的类型

在c++中常量值默认为内部链接，这使它们可以出现在标头文件中。

指向声明为const变量的指针只能赋给也声明为 const 的指针。

## 3.3 c++算术运算符
基本的运算符有+、-、*、/、%

**优先级和结合性**
*、/、%优先级相同，+、-优先级也相同但比乘除低。

当两个运算符优先级相同时，c++将看操作数的结合性，即从左到右还是从右到左。（大部分都是从左到右）

## 3.4 类型转换 

c++会自动执行很多类型转换：
- 将一种算术类型赋值给另一种算术变量时
- 表达式中包含不同的类型时
- 将参数传递给函数时

**1. 初始化和赋值的转换**
将较大的浮点型转为较小的浮点型，会导致精度（有效数位）降低，值可能会超出范围，结果将是不确定的。

将浮点类型转为整形，会导致小数部分丢失，原来的值可能会超出范围，结果将是不确定的。

将较大的整形转为较小的整形，可能会超出范围，通常只复制右边的字节。

**2. 以{}方式初始化时进行的转换**
c++11 将使用大括号的初始化称为列表初始化（list-initialization），通常用于给复杂的数据类型提供数字列表。列表初始化对类型转换更加严格，不允许缩窄（narrowing）。

**3. 表达式中的转换**
同一个表达式出现两种不同的算术类型时，c++将执行两种类型转换：
- 一些类型在出现时便会自动转换
- 有些类型在与其它类型同时出现在表达式中时将被转换

关于自动转换，在计算表达式时，c++将bool、char、unsigned char、signed char和short值转换为int。这被称为整形提升（integral promotion）。
```c++
short a = 20;
short b = 10;
short c = a+b;
```
在第三行中，c++取得a和b的值，将它们转为int。然后将结果转为short类型。通常int为计算机最自然的类型，在计算这种类型时，运算速度可能最快。


将不同类型进行算术运算时，也会进行一些转换。其中较小的类型将被转为较大的类型。编译器通过校验表来确定在算术表达式中的转换。以下为c++11的校验表：
> (1) 如果有一个操做数类型为long double，则将另一个转为long double\
> (2) 否则，如果有一个为double，将另一个转为double\
> (3) 否则，如果有一个为float，将另一个转为float\
> (4) 否则，进行整形提升\
> (5) 如果两个操做数都是有符号或无符号的，较低的转为较高的类型\
> (6) 如果其中一个有符号，另一个无符号且级比高，则将有符号转为无符号类型\
> (7) 否则，如果有符号类型可表示无符号类型的所有可能取值，则将无符号的转为有符号的所属类型\
> (8) 否则，将两个操作数都转为有符号类型的无符号版本。

**4. 传递参数时的转换**
通常由c++函数原型控制

**5. 强制类型转换**
通过强制类型转换进行显示的类型转换。有两种通用格式：
```c++
(int) thron
int (thron)
```
c++还引入了4个强制类型转换运算符如：
```c++
static_cast<int>(thron)
```
这有着更严格的限制。


## 3.5 c++11中的auto
auto根据初始值的类型推断变量的类型。

大多用于处理复杂类型，如STL中的类型。



