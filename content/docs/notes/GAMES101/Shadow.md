---
date: 2024-03-13
title: Shadows
weight: 2
---
-- How to draw shadows using rasterization?\
-- Shadow mapping!

# Shadow mapping
主要思想是：如果一个点不在阴影里那么在light和camera方向上是一定可以看到的（也有别的理解方式，现在主流是这种）。\
在经典shadow mapping中只能处理点光源，使用这种方法的阴影是硬阴影（Hard shadows）。

1. 在光源处做深度测试，得到场景中对于光源的各个物体的深度信息。
2. 在摄像机视角下，可以把看到的每个点投影到光源对应的深度图中，计算该点与光源的距离是否与深度图相等。如果相同，说明在光源方向和摄像机方向上是可见的，若不同则说明光源无法到达该点（被挡住了，即处于阴影中，计算颜色时就不需要光照分量）。

关于shadow map的一些问题：
- 是硬阴影
- 精度问题，计算机中比较浮点数是否相等很难，总会有误差
- 在光源处做深度测试，本质上就是在光源方向放个摄像机，那么深度图就会有分辨率，分辨率的大小直接影响阴影效果和性能
- 只有出现在shadow map中的物体才会渲染阴影，如果camera视角包括的物体多于shadow map中物体，那么有些物体阴影不会被渲染


# 软阴影
在物理上软阴影是阴影（本影，Umbra）的伴影（Penumbra），取决于光源的大小。如果出现软阴影则说明光源有一定的大小。
